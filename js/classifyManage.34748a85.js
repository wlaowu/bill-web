(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["classifyManage"],{2532:function(t,e,i){"use strict";var s=i("23e7"),n=i("e330"),o=i("5a34"),a=i("1d80"),c=i("577e"),l=i("ab13"),r=n("".indexOf);s({target:"String",proto:!0,forced:!l("includes")},{includes:function(t){return!!~r(c(a(this)),c(o(t)),arguments.length>1?arguments[1]:void 0)}})},"44e7":function(t,e,i){"use strict";var s=i("861d"),n=i("c6b6"),o=i("b622"),a=o("match");t.exports=function(t){var e;return s(t)&&(void 0!==(e=t[a])?!!e:"RegExp"===n(t))}},"5a34":function(t,e,i){"use strict";var s=i("44e7"),n=TypeError;t.exports=function(t){if(s(t))throw new n("The method doesn't accept regular expressions");return t}},"83f4":function(t,e,i){},"96b1":function(t,e,i){"use strict";i("83f4")},ab13:function(t,e,i){"use strict";var s=i("b622"),n=s("match");t.exports=function(t){var e=/./;try{"/./"[t](e)}catch(i){try{return e[n]=!1,"/./"[t](e)}catch(s){}}return!1}},b64b:function(t,e,i){"use strict";var s=i("23e7"),n=i("7b0b"),o=i("df75"),a=i("d039"),c=a((function(){o(1)}));s({target:"Object",stat:!0,forced:c},{keys:function(t){return o(n(t))}})},caad:function(t,e,i){"use strict";var s=i("23e7"),n=i("4d64").includes,o=i("d039"),a=i("44d2"),c=o((function(){return!Array(1).includes()}));s({target:"Array",proto:!0,forced:c},{includes:function(t){return n(this,t,arguments.length>1?arguments[1]:void 0)}}),a("includes")},d7f3:function(t,e,i){"use strict";i.r(e);var s=function(){var t=this,e=t._self._c;return e("div",{staticClass:"page-box"},[e("div",{staticClass:"wapper-box"},[e("div",{staticClass:"wapper-left"},[e("div",{staticClass:"left-header"},[e("el-input",{staticClass:"input-search",attrs:{placeholder:"请输入内容"},model:{value:t.groupForm.keyword,callback:function(e){t.$set(t.groupForm,"keyword",e)},expression:"groupForm.keyword"}},[e("template",{slot:"append"},[e("i",{staticClass:"el-icon-search",on:{click:t.searchSection}})])],2)],1),e("div",{staticClass:"left-btn-box"},[e("el-button",{attrs:{type:"primary"},on:{click:t.addClassifyHandle}},[t._v("新增分组")]),e("el-button",{on:{click:t.deleteAllHandle}},[t._v("批量删除")])],1),e("div",{staticClass:"left-content"},[t.groupLists.length>0?e("el-checkbox-group",{model:{value:t.groupSelects,callback:function(e){t.groupSelects=e},expression:"groupSelects"}},t._l(t.groupLists,(function(i){return e("div",{key:i.section_id,staticClass:"check-item",class:{"check-item-active":i.section_id===t.groupForm.section_id},on:{click:function(e){return t.selectGroup(i)}}},[e("el-checkbox",{attrs:{label:i.section_id}},[e("div",{staticClass:"check-label"},[t._v(t._s(i.section_name))])]),e("i",{staticClass:"el-icon-plus icon-edit",attrs:{title:"添加群到分组"},on:{click:function(e){return e.stopPropagation(),t.addSectionHandle(i)}}}),e("i",{staticClass:"el-icon-edit icon-edit",attrs:{title:"编辑分组"},on:{click:function(e){return e.stopPropagation(),t.editHandle(i)}}}),e("i",{staticClass:"el-icon-delete icon-delete",attrs:{title:"删除分组"},on:{click:function(e){return e.stopPropagation(),t.deleteHandle(i)}}})],1)})),0):t._e(),0===t.groupLists.length?e("div",{staticClass:"emtry-box"},[t._v("暂无数据")]):t._e()],1)]),e("div",{staticClass:"wapper-right"},[e("div",{staticClass:"right-header"},[e("div",[e("el-button",{on:{click:t.deleteAllGroupHandle}},[t._v("批量移除")])],1),e("el-input",{staticClass:"input-right-search",attrs:{placeholder:"请输入内容"},model:{value:t.groupForm.word,callback:function(e){t.$set(t.groupForm,"word",e)},expression:"groupForm.word"}},[e("template",{slot:"append"},[e("i",{staticClass:"el-icon-search",on:{click:t.searchGroup}})])],2)],1),e("div",{ref:"contentRef",staticClass:"right-content"},[e("el-table",{staticStyle:{width:"100%"},attrs:{data:t.markList,border:"",height:t.tableHeight},on:{"selection-change":t.handleSelectionChange}},[e("el-table-column",{attrs:{type:"selection",width:"55",align:"center"}}),e("el-table-column",{attrs:{prop:"group_title",label:"群名",align:"center"}}),e("el-table-column",{attrs:{prop:"owner_name",label:"群所有者",align:"center"}}),e("el-table-column",{attrs:{prop:"inviter_name",label:"群邀请人",align:"center"}}),e("el-table-column",{attrs:{label:"操作",align:"center"},scopedSlots:t._u([{key:"default",fn:function(i){return[e("el-button",{attrs:{size:"mini",type:"text"},on:{click:function(e){return t.deleteGroupSingleHandle(i.row)}}},[t._v("移除")])]}}])})],1)],1)])]),t.showClassify?e("add-classify",{attrs:{type:t.operType,data:t.groupObject},on:{close:t.closeHandle,save:t.saveClassifyHandle}}):t._e(),t.showSection?e("section-add",{attrs:{id:t.id,selectList:t.selectSections},on:{close:function(e){t.showSection=!1},save:t.saveSectionHandle}}):t._e()],1)},n=[],o=(i("4de4"),i("7db0"),i("caad"),i("d81d"),i("14d9"),i("e9c4"),i("b64b"),i("d3b7"),i("2532"),i("3ca3"),i("159b"),i("ddb0"),i("b562")),a=function(){var t=this,e=t._self._c;return e("el-dialog",{attrs:{title:t.title,visible:t.dialogVisible,width:"30%","before-close":t.handleClose},on:{"update:visible":function(e){t.dialogVisible=e}}},[e("el-input",{attrs:{placeholder:"请输入分组名称"},model:{value:t.data.section_name,callback:function(e){t.$set(t.data,"section_name",e)},expression:"data.section_name"}}),e("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[e("el-button",{on:{click:t.handleClose}},[t._v("取 消")]),e("el-button",{attrs:{type:"primary"},on:{click:t.saveHandle}},[t._v("确 定")])],1)],1)},c=[],l={props:{data:{type:Object,required:!0,default:function(){return{}}},type:{type:String,required:!0,default:"add"}},data:function(){return{dialogVisible:!0,title:"新增分组"}},mounted:function(){this.dialogVisible=!0,this.title="add"===this.type?"新增分组":"编辑分组"},methods:{handleClose:function(t){this.$emit("close")},saveHandle:function(){this.data.section_name?this.$emit("save",this.data):this.$message({message:"分组名称不能为空",type:"warning"})}}},r=l,d=i("2877"),u=Object(d["a"])(r,a,c,!1,null,"099f029b",null),p=u.exports,h=function(){var t=this,e=t._self._c;return e("el-dialog",{attrs:{title:t.title,visible:t.dialogVisible,width:"40%","before-close":t.handleClose},on:{"update:visible":function(e){t.dialogVisible=e}}},[e("el-transfer",{attrs:{data:t.list,props:t.transferProps,titles:["待选群列表","选中群列表"]},model:{value:t.selectArray,callback:function(e){t.selectArray=e},expression:"selectArray"}}),e("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[e("el-button",{on:{click:t.handleClose}},[t._v("取 消")]),e("el-button",{attrs:{type:"primary"},on:{click:t.saveHandle}},[t._v("确 定")])],1)],1)},f=[],g={props:{sectionId:{type:String,default:""},id:{type:String,default:""},selectList:{type:Array,default:function(){return[]}}},watch:{sectionId:function(){this.getList()},selectList:{handler:function(){this.selectArray=JSON.parse(JSON.stringify(this.selectList))},deep:!0,immediate:!0}},data:function(){return{dialogVisible:!0,list:[],title:"添加群到分组",transferProps:{label:"group_title",key:"group_id"},selectArray:[]}},mounted:function(){this.dialogVisible=!0,this.getList()},methods:{handleClose:function(t){this.$emit("close")},saveHandle:function(){this.$emit("save",this.selectArray)},getList:function(){var t=this;this.id&&Object(o["f"])({id:this.id}).then((function(e){200===e.code&&(t.list=e.data)}))}}},m=g,b=Object(d["a"])(m,h,f,!1,null,null,null),y=b.exports,v={components:{addClassify:p,sectionAdd:y},data:function(){return{id:"5415202864",groupLists:[],groupAllLists:[],groupForm:{keyword:"",word:"",section_id:""},groupSelects:[],tableHeight:200,markList:[],markAllLists:[],showClassify:!1,operType:"add",groupObject:{},showSection:!1,selectSections:[],selectSectionsCopy:[],addSectionId:"",selectGroupList:[]}},mounted:function(){this.id=this.$route.query.id||"5415202864",this.getGroupData(),this.initHandle()},methods:{initHandle:function(){var t=this;this.$nextTick((function(){t.tableHeight=t.$refs.contentRef.clientHeight}))},selectGroup:function(t){this.groupForm.section_id=t.section_id,this.getSectionData()},getGroupData:function(){var t=this;Object(o["e"])({id:this.id}).then((function(e){200===e.code&&(t.groupLists=e.data||[],t.groupAllLists=JSON.parse(JSON.stringify(e.data)),t.groupForm.section_id=t.groupLists[0]&&t.groupLists[0].section_id||"",t.getSectionData())})).catch((function(){t.groupLists=[],t.groupAllLists=[],t.groupForm.section_id="",t.markList=[],t.markAllLists=[]}))},getDialogSectionData:function(t){var e=this,i={id:this.id,section_id:t};Object(o["g"])(i).then((function(t){if(200===t.code){var i=t.data||[];e.selectSections=i.map((function(t){return t.group_id})),e.selectSectionsCopy=JSON.parse(JSON.stringify(e.selectSections)),e.showSection=!0}}))},getSectionData:function(){var t=this,e={id:this.id,section_id:this.groupForm.section_id};Object(o["g"])(e).then((function(e){200===e.code&&(t.markList=e.data||[],t.markAllLists=JSON.parse(JSON.stringify(e.data)))}))},addSectionHandle:function(t){this.addSectionId=t.section_id,this.getDialogSectionData(t.section_id)},closeHandle:function(){this.showClassify=!1},addClassifyHandle:function(){this.operType="add",this.showClassify=!0},editHandle:function(t){this.operType="edit",this.groupObject=t,this.showClassify=!0},saveClassifyHandle:function(t){var e=this,i=null;"add"===this.operType?i=o["b"]:"edit"===this.operType&&(i=o["i"]),i({id:this.id},t).then((function(t){200===t.code&&(e.closeHandle(),e.getGroupData(),e.$message({type:"success",message:"保存成功"}))}))},saveSectionHandle:function(t){var e=this;console.log(t,this.selectSectionsCopy);var i=[],s=[];this.selectSectionsCopy.forEach((function(e){var i=t.find((function(t){return t===e}));i||s.push(e)})),t.forEach((function(t){var s=e.selectSectionsCopy.find((function(e){return e===t}));s||i.push(t)})),console.log(90,i,s);var n=new Promise((function(t,s){0!==i.length?Object(o["a"])({id:e.id},{group_ids:i,section_id:e.addSectionId}).then((function(e){200===e.code&&t()})):t()})),a=new Promise((function(t,i){0!==s.length?Object(o["h"])({id:e.id},{section_id:e.addSectionId,group_ids:s}).then((function(e){200===e.code&&t()})):t()}));Promise.all([n,a]).then((function(){e.showSection=!1,e.$message({type:"success",message:"保存成功"}),e.getSectionData()}))},deleteHandle:function(t){this.deleteClassifyHandle([t.section_id])},deleteAllHandle:function(){this.groupSelects.length>0?this.deleteClassifyHandle(this.groupSelects):this.$message({type:"warning",message:"请选择要删除的分组"})},deleteClassifyHandle:function(t){var e=this;this.$confirm("此操作将永久删除该分组, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){Object(o["c"])({id:e.id},{section_ids:t}).then((function(t){200===t.code&&(e.$message({type:"success",message:"删除成功"}),e.getGroupData())}))})).catch((function(){}))},handleSelectionChange:function(t){this.selectGroupList=t},deleteAllGroupHandle:function(){if(this.selectGroupList.length>0){var t=this.selectGroupList.map((function(t){return t.group_id}));this.deleteGroupHandle(t)}else this.$message({type:"warning",message:"请选择要移除的群"})},deleteGroupSingleHandle:function(t){this.deleteGroupHandle([t.group_id])},deleteGroupHandle:function(t){var e=this;this.$confirm("此操作将该群从分组中移除, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){Object(o["h"])({id:e.id},{section_id:e.groupForm.section_id,group_ids:t}).then((function(t){200===t.code&&(e.$message({type:"success",message:"移除成功"}),e.getSectionData())}))})).catch((function(){}))},searchSection:function(){var t=this;this.groupForm.keyword?this.groupLists=this.groupAllLists.filter((function(e){return e.section_name.includes(t.groupForm.keyword)})):this.groupLists=JSON.parse(JSON.stringify(this.groupAllLists))},searchGroup:function(){var t=this;this.groupForm.word?this.markList=this.markAllLists.filter((function(e){return e.group_title.includes(t.groupForm.word)})):this.markList=JSON.parse(JSON.stringify(this.markAllLists))}}},_=v,S=(i("96b1"),Object(d["a"])(_,s,n,!1,null,"d1c81146",null));e["default"]=S.exports}}]);
//# sourceMappingURL=classifyManage.34748a85.js.map